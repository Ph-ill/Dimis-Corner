<!DOCTYPE html>
<html lang="{{ .Site.Language }}">
<head>
    <title>{{ if not .IsHome }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>
    <link rel="canonical" href="{{ .Site.BaseURL }}">
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="shortcut icon" href="/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    
    <meta name="description" content="{{ with .Params.description }}{{ . }}{{ else }}{{ .Summary }}{{ end }}">
    
    {{ if isset .Params "tags" }}
    <meta name="keywords" content="{{ with .Params.tags }}{{ delimit . ", " }}{{ end }}">
    {{ end }}
    
    {{ partial "style.html" . }}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="index, follow">
    <meta charset="utf-8">
    <script>
        // Dynamic random background tile selector
        document.addEventListener('DOMContentLoaded', function() {
            const backgroundTiles = [
                {{- $bgTilesDir := "bg_tiles" -}}
                {{- range $path := (readDir (printf "static/%s" $bgTilesDir)) -}}
                {{- if not .IsDir -}}
                {{- $ext := path.Ext .Name | lower -}}
                {{- if or (eq $ext ".jpg") (eq $ext ".jpeg") (eq $ext ".png") (eq $ext ".gif") (eq $ext ".webp") (eq $ext ".bmp") -}}
                '/{{ $bgTilesDir }}/{{ .Name }}',
                {{- end -}}
                {{- end -}}
                {{- end -}}
            ];
            
            // Only proceed if we have background tiles
            if (backgroundTiles.length > 0) {
                // Select a random background
                const randomBg = backgroundTiles[Math.floor(Math.random() * backgroundTiles.length)];
                
                // Apply the background to the body
                document.body.style.backgroundImage = `url(${randomBg})`;
                document.body.style.backgroundRepeat = 'repeat';
                document.body.style.backgroundAttachment = 'fixed';
            }
        });
    </script>
</head>
<body>
        <header><h1 id="{{ .Site.Title }}"><a href="{{ absLangURL "/" }}"><img src="/Title.png" alt="{{ .Site.Title }}" style="max-width: 100%; height: auto;"></a></h1></header>
<main>
    {{ block "main" . }}{{ end }}
    {{ if .Param "nextprev" }}{{ partial "nextprev.html" . }}{{ end }}
</main>
</body>
</html>
